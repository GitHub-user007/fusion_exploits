set disassembly-flavor intel
set follow-fork-mode child

break *validate_credentials+21
commands
silent
printf "Canary: %08x\n", $eax
cont
end

break *validate_credentials+337
commands
silent
printf "Overwritten Canary: %08x\n", $edx
cont
end

break *validate_credentials+361
commands
silent
x/32wx $esp
cont
end

continue quit

# loop using:
# while true; do sudo gdb -q -x lazy --pid=$(pidof level04); echo "again? "; read c; if [[ "$c" != "y" ]]; then break ; fi ; done
